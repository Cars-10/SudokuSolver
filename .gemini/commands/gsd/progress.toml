description = "Check project progress, show context, and route to next action (execute or plan)"
prompt = "<objective>\nCheck project progress, summarize recent work and what's ahead, then intelligently route to the next action - either executing an existing plan or creating the next one.\n\nProvides situational awareness before continuing work.\n</objective>\n\n\n<process>\n\n<step name=\"verify\">\n**Verify planning structure exists:**\n\nIf no `.planning/` directory:\n\n```\nNo planning structure found.\n\nRun /gsd:new-project to start a new project.\n```\n\nExit.\n\nIf missing STATE.md or ROADMAP.md: inform what's missing, suggest running `/gsd:new-project`.\n</step>\n\n<step name=\"load\">\n**Load full project context:**\n\n- Read `.planning/STATE.md` for living memory (position, decisions, issues)\n- Read `.planning/ROADMAP.md` for phase structure and objectives\n- Read `.planning/PROJECT.md` for current state (What This Is, Core Value, Requirements)\n  </step>\n\n<step name=\"recent\">\n**Gather recent work context:**\n\n- Find the 2-3 most recent SUMMARY.md files\n- Extract from each: what was accomplished, key decisions, any issues logged\n- This shows \"what we've been working on\"\n  </step>\n\n<step name=\"position\">\n**Parse current position:**\n\n- From STATE.md: current phase, plan number, status\n- Calculate: total plans, completed plans, remaining plans\n- Note any blockers, concerns, or deferred issues\n- Check for CONTEXT.md: For phases without PLAN.md files, check if `{phase}-CONTEXT.md` exists in phase directory\n- Count pending todos: `ls .planning/todos/pending/*.md 2>/dev/null | wc -l`\n  </step>\n\n<step name=\"report\">\n**Present rich status report:**\n\n```\n# [Project Name]\n\n**Progress:** [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘] 8/10 plans complete\n\n## Recent Work\n- [Phase X, Plan Y]: [what was accomplished - 1 line]\n- [Phase X, Plan Z]: [what was accomplished - 1 line]\n\n## Current Position\nPhase [N] of [total]: [phase-name]\nPlan [M] of [phase-total]: [status]\nCONTEXT: [âœ“ if CONTEXT.md exists | - if not]\n\n## Key Decisions Made\n- [decision 1 from STATE.md]\n- [decision 2]\n\n## Open Issues\n- [any deferred issues or blockers]\n\n## Pending Todos\n- [count] pending â€” /gsd:check-todos to review\n\n## What's Next\n[Next phase/plan objective from ROADMAP]\n```\n\n</step>\n\n<step name=\"route\">\n**Determine next action based on verified counts.**\n\n**Step 1: Count plans, summaries, and issues in current phase**\n\nList files in the current phase directory:\n\n```bash\nls -1 .planning/phases/[current-phase-dir]/*-PLAN.md 2>/dev/null | wc -l\nls -1 .planning/phases/[current-phase-dir]/*-SUMMARY.md 2>/dev/null | wc -l\nls -1 .planning/phases/[current-phase-dir]/*-ISSUES.md 2>/dev/null | wc -l\nls -1 .planning/phases/[current-phase-dir]/*-FIX.md 2>/dev/null | wc -l\nls -1 .planning/phases/[current-phase-dir]/*-FIX-SUMMARY.md 2>/dev/null | wc -l\n```\n\nState: \"This phase has {X} plans, {Y} summaries, {Z} issues files, {W} fix plans.\"\n\n**Step 1.5: Check for unaddressed UAT issues**\n\nFor each *-ISSUES.md file, check if matching *-FIX.md exists.\nFor each *-FIX.md file, check if matching *-FIX-SUMMARY.md exists.\n\nTrack:\n- `issues_without_fix`: ISSUES.md files without FIX.md\n- `fixes_without_summary`: FIX.md files without FIX-SUMMARY.md\n\n**Step 2: Route based on counts**\n\n| Condition | Meaning | Action |\n|-----------|---------|--------|\n| fixes_without_summary > 0 | Unexecuted fix plans exist | Go to **Route A** (with FIX.md) |\n| issues_without_fix > 0 | UAT issues need fix plans | Go to **Route E** |\n| summaries < plans | Unexecuted plans exist | Go to **Route A** |\n| summaries = plans AND plans > 0 | Phase complete | Go to Step 3 |\n| plans = 0 | Phase not yet planned | Go to **Route B** |\n\n---\n\n**Route A: Unexecuted plan exists**\n\nFind the first PLAN.md without matching SUMMARY.md.\nRead its `<objective>` section.\n\n```\n---\n\n## â–¶ Next Up\n\n**{phase}-{plan}: [Plan Name]** â€” [objective summary from PLAN.md]\n\n`/gsd:execute-plan [full-path-to-PLAN.md]`\n\n<sub>`/clear` first â†’ fresh context window</sub>\n\n---\n```\n\n---\n\n**Route B: Phase needs planning**\n\nCheck if `{phase}-CONTEXT.md` exists in phase directory.\n\n**If CONTEXT.md exists:**\n\n```\n---\n\n## â–¶ Next Up\n\n**Phase {N}: {Name}** â€” {Goal from ROADMAP.md}\n<sub>âœ“ Context gathered, ready to plan</sub>\n\n`/gsd:plan-phase {phase-number}`\n\n<sub>`/clear` first â†’ fresh context window</sub>\n\n---\n```\n\n**If CONTEXT.md does NOT exist:**\n\n```\n---\n\n## â–¶ Next Up\n\n**Phase {N}: {Name}** â€” {Goal from ROADMAP.md}\n\n`/gsd:plan-phase {phase}`\n\n<sub>`/clear` first â†’ fresh context window</sub>\n\n---\n\n**Also available:**\n- `/gsd:discuss-phase {phase}` â€” gather context first\n- `/gsd:research-phase {phase}` â€” investigate unknowns\n- `/gsd:list-phase-assumptions {phase}` â€” see Gemini's assumptions\n\n---\n```\n\n---\n\n**Route E: UAT issues need fix plans**\n\nISSUES.md exists without matching FIX.md. User needs to plan fixes.\n\n```\n---\n\n## âš  UAT Issues Found\n\n**{plan}-ISSUES.md** has {N} issues without a fix plan.\n\n`/gsd:plan-fix {plan}`\n\n<sub>`/clear` first â†’ fresh context window</sub>\n\n---\n\n**Also available:**\n- `/gsd:execute-plan [path]` â€” continue with other work first\n- `/gsd:verify-work {phase}` â€” run more UAT testing\n\n---\n```\n\n---\n\n**Step 3: Check milestone status (only when phase complete)**\n\nRead ROADMAP.md and identify:\n1. Current phase number\n2. All phase numbers in the current milestone section\n\nCount total phases and identify the highest phase number.\n\nState: \"Current phase is {X}. Milestone has {N} phases (highest: {Y}).\"\n\n**Route based on milestone status:**\n\n| Condition | Meaning | Action |\n|-----------|---------|--------|\n| current phase < highest phase | More phases remain | Go to **Route C** |\n| current phase = highest phase | Milestone complete | Go to **Route D** |\n\n---\n\n**Route C: Phase complete, more phases remain**\n\nRead ROADMAP.md to get the next phase's name and goal.\n\n```\n---\n\n## âœ“ Phase {Z} Complete\n\n## â–¶ Next Up\n\n**Phase {Z+1}: {Name}** â€” {Goal from ROADMAP.md}\n\n`/gsd:plan-phase {Z+1}`\n\n<sub>`/clear` first â†’ fresh context window</sub>\n\n---\n\n**Also available:**\n- `/gsd:verify-work {Z}` â€” user acceptance test before continuing\n- `/gsd:discuss-phase {Z+1}` â€” gather context first\n- `/gsd:research-phase {Z+1}` â€” investigate unknowns\n\n---\n```\n\n---\n\n**Route D: Milestone complete**\n\n```\n---\n\n## ðŸŽ‰ Milestone Complete\n\nAll {N} phases finished!\n\n## â–¶ Next Up\n\n**Complete Milestone** â€” archive and prepare for next\n\n`/gsd:complete-milestone`\n\n<sub>`/clear` first â†’ fresh context window</sub>\n\n---\n\n**Also available:**\n- `/gsd:verify-work` â€” user acceptance test before completing milestone\n\n---\n```\n\n</step>\n\n<step name=\"edge_cases\">\n**Handle edge cases:**\n\n- Phase complete but next phase not planned â†’ offer `/gsd:plan-phase [next]`\n- All work complete â†’ offer milestone completion\n- Blockers present â†’ highlight before offering to continue\n- Handoff file exists â†’ mention it, offer `/gsd:resume-work`\n  </step>\n\n</process>\n\n<success_criteria>\n\n- [ ] Rich context provided (recent work, decisions, issues)\n- [ ] Current position clear with visual progress\n- [ ] What's next clearly explained\n- [ ] Smart routing: /gsd:execute-plan if plan exists, /gsd:plan-phase if not\n- [ ] User confirms before any action\n- [ ] Seamless handoff to appropriate gsd command\n      </success_criteria>"
