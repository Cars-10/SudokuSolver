---
phase: 02-compiled-languages-wave
plan: 01
type: execute
---

<objective>
Implement C++ solver following the established C baseline pattern.

Purpose: First language expansion beyond C — validates the benchmark framework can scale.
Output: C++ passing all 5 matrices with exact iteration count matches, runMe.sh using common.sh, README.md documentation.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/02-compiled-languages-wave/2-CONTEXT.md

**Reference Implementation:**
@Languages/C/runMe.sh
@Languages/C/Sudoku.c
@Languages/common.sh

**Existing C++ Code:**
@Languages/C++/Sudoku.cpp

**Reference Iteration Counts (must match exactly):**
- Matrix 1: 656
- Matrix 2: 439,269
- Matrix 3: 98,847
- Matrix 4: 9,085
- Matrix 5: 445,778

**Prior decisions:**
- Phase 1 established common.sh modular pattern — all languages must use it
- Output format must match C exactly (path prefix, spacing, "Solved in Iterations=X")
- Algorithm must be pure brute-force (row-major search, 1-9 candidate order)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Align C++ solver output format with C reference</name>
  <files>Languages/C++/Sudoku.cpp</files>
  <action>
Update Sudoku.cpp to match C output format exactly:

1. In readMatrixFile(): Add path normalization and printing BEFORE reading
   - If path starts with "/app/Matrices/", print "../Matrices/X.matrix"
   - Otherwise print the path as-is
   - Print each row as it's read (like C does)

2. Verify algorithm matches C:
   - Row-major search order (outer loop j=0-8, inner loop i=0-8)
   - Candidate order 1-9 ascending
   - Count incremented BEFORE isPossible check (count every attempt)
   - Output: "Solved in Iterations=X" (no extra newline before)

3. Timing output: "Seconds to process %.3f" format

DO NOT change the core algorithm logic — only output formatting.
  </action>
  <verify>Compile with g++ -O3 and run on Matrix 1. Output should show path, input puzzle, solved puzzle, iterations=656, timing.</verify>
  <done>C++ output format matches C reference exactly for Matrix 1</done>
</task>

<task type="auto">
  <name>Task 2: Create runMe.sh and validate all matrices</name>
  <files>Languages/C++/runMe.sh</files>
  <action>
Create runMe.sh following C pattern exactly:

```bash
#!/bin/bash
cd "$(dirname "$0")"

LANGUAGE="C++"
SOLVER_BINARY="./Sudoku"
METRICS_FILE="metrics.json"
TIMEOUT_SECONDS=300

source ../common.sh

compile() {
    check_toolchain g++
    if [ ! -f "Sudoku.cpp" ]; then
        report_env_error "Sudoku.cpp not found"
    fi
    echo "Compiling C++ solver with -O3 optimization..."
    g++ -O3 -o Sudoku Sudoku.cpp
    if [ $? -ne 0 ]; then
        report_env_error "Compilation failed"
    fi
    echo "Compilation successful: ./Sudoku"
}

get_compile_flags() {
    local variant="${1:-default}"
    case "$variant" in
        O0) echo "-O0" ;;
        O2) echo "-O2" ;;
        O3|default) echo "-O3" ;;
        Ofast) echo "-Ofast" ;;
        *) echo "-O3" ;;
    esac
}

main "$@"
```

Then run validation:
1. Execute: cd Languages/C++ && ./runMe.sh
2. Check metrics.json for all 5 matrices
3. Verify iteration counts match EXACTLY:
   - Matrix 1: 656
   - Matrix 2: 439,269
   - Matrix 3: 98,847
   - Matrix 4: 9,085
   - Matrix 5: 445,778

If ANY iteration count doesn't match, the algorithm has drift — fix Sudoku.cpp before proceeding.
  </action>
  <verify>cat Languages/C++/metrics.json | grep iterations — all 5 must match reference</verify>
  <done>All 5 matrices pass with exact iteration count matches, metrics.json generated</done>
</task>

<task type="auto">
  <name>Task 3: Document C++ implementation</name>
  <files>Languages/C++/README.md</files>
  <action>
Update README.md with:

1. **Validation Status** section showing all 5 matrices pass
2. **Compilation** section with g++ commands and variants
3. **Algorithm** section confirming brute-force match with C
4. **Performance** section with typical timing (from metrics.json)

Format similar to Languages/C/README.md but for C++.

Also delete the old setupAndRunMe.sh if it exists (replaced by runMe.sh).
  </action>
  <verify>cat Languages/C++/README.md shows validation status and compilation instructions</verify>
  <done>README.md documents validated C++ implementation, old scripts removed</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `g++ -O3 -o Sudoku Sudoku.cpp` compiles without errors
- [ ] C++ output format matches C exactly (diff test)
- [ ] All 5 iteration counts match reference (656, 439269, 98847, 9085, 445778)
- [ ] metrics.json exists with all results
- [ ] README.md updated with validation status
</verification>

<success_criteria>
- C++ solver compiles and runs all 5 matrices
- Iteration counts match C reference exactly (zero tolerance)
- runMe.sh uses common.sh pattern
- README.md documents implementation
- Old setupAndRunMe.sh removed
</success_criteria>

<output>
After completion, create `.planning/phases/02-compiled-languages-wave/02-01-SUMMARY.md`:

# Phase 2 Plan 01: C++ Implementation Summary

**[One-liner: what shipped]**

## Accomplishments
- [Key outcomes]

## Files Created/Modified
- `Languages/C++/Sudoku.cpp` - [changes]
- `Languages/C++/runMe.sh` - [created]
- `Languages/C++/README.md` - [updated]

## Validation Results
| Matrix | Expected | Actual | Status |
|--------|----------|--------|--------|
| 1 | 656 | ? | ? |
| 2 | 439269 | ? | ? |
| 3 | 98847 | ? | ? |
| 4 | 9085 | ? | ? |
| 5 | 445778 | ? | ? |

## Issues Encountered
[Problems and resolutions, or "None"]

## Next Step
Ready for 02-02-PLAN.md (Go implementation)
</output>
