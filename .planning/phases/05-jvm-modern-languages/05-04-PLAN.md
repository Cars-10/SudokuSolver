---
phase: 05-jvm-modern-languages
plan: 04
type: execute
---

<objective>
Implement Scala Sudoku solver with exact algorithm match and C reference output format.

Purpose: Add Scala to the validated benchmark suite (JVM language with functional features)
Output: Working Scala solver passing all 5 matrix validations with exact iteration counts
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

**Reference implementation (use Java as closest match):**
@Languages/Java/Sudoku.java
@Languages/Kotlin/Sudoku.kt (once completed)

**Existing Scala (stub only - needs full implementation):**
@Languages/Scala/Sudoku.scala

**Reference iteration counts:**
- Matrix 1: 656
- Matrix 2: 439,269
- Matrix 3: 98,847
- Matrix 4: 9,085
- Matrix 5: 445,778

**Scala-specific notes:**
- Compiles to JVM bytecode
- Use imperative style (var, mutable array) to match C algorithm exactly
- Avoid functional idioms that would change iteration order
- Compiles with scalac, runs with scala or java
</context>

<tasks>

<task type="auto">
  <name>Task 1: Implement Scala solver</name>
  <files>Languages/Scala/Sudoku.scala</files>
  <action>
    Create complete Scala Sudoku solver matching C reference algorithm EXACTLY:

    **Algorithm (MUST match C - use imperative style):**
    - Search order: Row-major (top-to-bottom, left-to-right)
    - Candidate values: 1-9 in ascending order
    - Iteration counting: Every value placement attempt increments count
    - Use mutable state (var puzzle, var count) - NOT functional style

    **Structure:**
    ```scala
    object Sudoku {
      var puzzle: Array[Array[Int]] = Array.ofDim[Int](9, 9)
      var count: Long = 0

      def isPossible(y: Int, x: Int, value: Int): Boolean = { ... }
      def solve(): Boolean = { ... }  // Recursive, row-major search
      def readMatrixFile(filename: String): Unit = { ... }
      def printPuzzle(): Unit = { ... }
      def main(args: Array[String]): Unit = { ... }
    }
    ```

    **Output format (EXACT match to C):**
    1. Print path
    2. Echo raw matrix rows as read
    3. Blank line
    4. "Puzzle:" + initial state
    5. Blank line
    6. "Puzzle:" + solved state
    7. Blank line
    8. "Solved in Iterations={count}"
    9. Blank line
    10. "Seconds to process {time:.3f}"

    Use System.nanoTime() for timing.
    Print with space after each value, newline after each row.
  </action>
  <verify>scalac Sudoku.scala && scala Sudoku ../../Matrices/1.matrix</verify>
  <done>Scala solver compiles and produces output with correct iteration count (656 for Matrix 1)</done>
</task>

<task type="auto">
  <name>Task 2: Create Scala runMe.sh and validate</name>
  <files>Languages/Scala/runMe.sh, Languages/Scala/README.md, Languages/Scala/metrics.json</files>
  <action>
    1. Create runMe.sh following common.sh pattern:
       - Set LANGUAGE="Scala"
       - Set SOLVER_BINARY="scala Sudoku"
       - Add compile() using scalac
       - Source ../common.sh
       - Override run_matrix() for scala execution
       - Call main "$@"

    2. Compile and run all 5 matrices:
       ./runMe.sh ../../Matrices/{1,2,3,4,5}.matrix

    3. Validate iteration counts match reference exactly

    4. Create README.md documenting:
       - Validation status table
       - Algorithm description (imperative style matching C)
       - Requirements (Scala 3.x, JVM)
       - Compilation and execution instructions
       - Note about using imperative style for algorithm accuracy
  </action>
  <verify>
    1. grep "iterations.*656" Languages/Scala/metrics.json
    2. All 5 matrices show "success" status
  </verify>
  <done>Scala fully validated with all 5 matrices passing, README.md complete</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] Scala compiles without errors
- [ ] Output matches C reference format exactly
- [ ] All 5 matrices pass iteration validation
- [ ] metrics.json populated with all results
- [ ] README.md documents validation status
</verification>

<success_criteria>
- Scala solver produces exact output format matching C
- All iteration counts match C reference
- No compilation errors
- Documented and ready for benchmark inclusion
</success_criteria>

<output>
After completion, create `.planning/phases/05-jvm-modern-languages/05-04-SUMMARY.md`
</output>
