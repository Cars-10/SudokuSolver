---
phase: 07-c-family-languages
plan: 01
type: execute
depends_on: []
files_modified: [
  Algorithms/DLX/C++/dlx.h,
  Algorithms/DLX/C++/dlx_core.cpp,
  Algorithms/DLX/C++/dlx_sudoku.cpp,
  Algorithms/DLX/C++/runMe.sh,
  Algorithms/CP/C++/cp.h,
  Algorithms/CP/C++/cp_core.cpp,
  Algorithms/CP/C++/cp_sudoku.cpp,
  Algorithms/CP/C++/runMe.sh
]
---

<objective>
Implement DLX and CP algorithms for C++ using modern C++ idioms while maintaining algorithmic compatibility with C reference implementations.

Purpose: Extend algorithm coverage to C++ as the first C-family language port, establishing the pattern for subsequent C-family implementations.
Output: Functional DLX and CP solvers in C++ with verified iteration counts matching C reference (DLX: 43, CP: 67 on Matrix 1).
</objective>

<execution_context>
./.claude/get-shit-done/workflows/execute-plan.md
./summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

# C reference implementations
@Algorithms/DLX/C/dlx.h
@Algorithms/DLX/C/dlx_core.c
@Algorithms/DLX/C/dlx_sudoku.c
@Algorithms/CP/C/cp.h
@Algorithms/CP/C/cp_core.c
@Algorithms/CP/C/cp_sudoku.c

# Build patterns
@Algorithms/DLX/C/runMe.sh
@Algorithms/CP/C/runMe.sh

**Tech stack available:**
- C++ compiler (g++ or clang++)
- Existing benchmark harness (common.sh)
- Established algorithm patterns from v1.1

**Established patterns:**
- DLX: 130 LOC core + 333 LOC sudoku mapping
- CP: 361 LOC core + 136 LOC sudoku integration
- Three-file structure: header, core algorithm, sudoku integration
- runMe.sh sources ../../common.sh for benchmarking

**Constraining decisions:**
- Phase 2: DLX iteration counting = dlx_search() calls
- Phase 3: CP iteration counting = assign() calls
- Phase 2: Pre-allocated node pool for DLX (729*4 max nodes)
- Phase 3: Bitset representation for CP candidates (uint16_t)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Port DLX algorithm to C++</name>
  <files>Algorithms/DLX/C++/dlx.h, Algorithms/DLX/C++/dlx_core.cpp, Algorithms/DLX/C++/dlx_sudoku.cpp, Algorithms/DLX/C++/runMe.sh</files>
  <action>
Create Algorithms/DLX/C++/ directory. Port the C DLX implementation to C++:

1. **dlx.h**: Convert to C++ header
   - Use `class DlxNode` and `class DlxColumn` instead of structs
   - Keep same data members (up/down/left/right pointers, column pointer, row_id, size, name)
   - Add constructor declarations
   - Declare `extern int dlx_iterations` for iteration counting

2. **dlx_core.cpp**: Port core algorithm
   - Implement cover_column(), uncover_column(), choose_column(), dlx_search()
   - Maintain EXACT same algorithm logic as C (no STL containers, same pointer manipulation)
   - Keep iteration counting identical (increment on every dlx_search() call)
   - Use C++ style (references where appropriate, but keep pointer logic identical)

3. **dlx_sudoku.cpp**: Port Sudoku integration
   - Implement init_dlx_matrix(), build_dlx_matrix_from_puzzle(), extract_solution()
   - Keep same exact cover mapping (324 columns: 81 position + 81 row + 81 col + 81 box)
   - Maintain same I/O format (readMatrixFile(), printPuzzle())
   - Same main() orchestration with timing

4. **runMe.sh**: Create build script
   - Set LANGUAGE="C++", SOLVER_BINARY="./dlx_solver", METRICS_FILE="metrics.json"
   - Source ../../common.sh
   - compile() function: `g++ -O2 -o dlx_solver dlx_core.cpp dlx_sudoku.cpp`
   - Call main "$@"

**Critical**: Port is mechanical translation, NOT redesign. Keep algorithm identical to ensure iteration counts match.
  </action>
  <verify>
cd Algorithms/DLX/C++ && ./runMe.sh ../../Matrices/1.matrix
Check output shows "Iterations=43" (must match C reference)
  </verify>
  <done>DLX C++ implementation compiles, runs, produces 43 iterations on Matrix 1, metrics.json generated</done>
</task>

<task type="auto">
  <name>Task 2: Port CP algorithm to C++</name>
  <files>Algorithms/CP/C++/cp.h, Algorithms/CP/C++/cp_core.cpp, Algorithms/CP/C++/cp_sudoku.cpp, Algorithms/CP/C++/runMe.sh</files>
  <action>
Create Algorithms/CP/C++/ directory. Port the C CP implementation to C++:

1. **cp.h**: Convert to C++ header
   - Keep `typedef uint16_t CandidateSet` (bitset representation)
   - Use `struct CPGrid` or `class CPGrid` with same members (values[9][9], candidates[9][9])
   - Keep same candidate manipulation macros (HAS_CANDIDATE, ADD_CANDIDATE, REMOVE_CANDIDATE, COUNT_CANDIDATES)
   - Declare `extern long long cp_iterations`

2. **cp_core.cpp**: Port core algorithm
   - Implement init_grid(), propagate(), eliminate(), assign(), cp_search(), find_mrv_cell()
   - Maintain EXACT same constraint propagation logic (eliminate from row/col/box peers)
   - Keep iteration counting identical (increment on every assign() call)
   - Use bitset operations exactly as in C (no std::bitset)

3. **cp_sudoku.cpp**: Port Sudoku integration
   - Implement readMatrixFile(), printPuzzle(), main()
   - Same initialization: fill candidates with all 1-9, eliminate given clues
   - Same search: find MRV cell, try each candidate, backtrack on failure
   - Same output format

4. **runMe.sh**: Create build script
   - Set LANGUAGE="C++", SOLVER_BINARY="./cp_solver", METRICS_FILE="metrics.json"
   - Source ../../common.sh
   - compile() function: `g++ -O2 -o cp_solver cp_core.cpp cp_sudoku.cpp`
   - Call main "$@"

**Critical**: Maintain bitset operations and propagation order to ensure iteration counts match.
  </action>
  <verify>
cd Algorithms/CP/C++ && ./runMe.sh ../../Matrices/1.matrix
Check output shows "Iterations=67" (must match C reference)
  </verify>
  <done>CP C++ implementation compiles, runs, produces 67 iterations on Matrix 1, metrics.json generated</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] Both DLX and CP C++ implementations compile without errors
- [ ] DLX C++ produces exactly 43 iterations on Matrix 1
- [ ] CP C++ produces exactly 67 iterations on Matrix 1
- [ ] Both metrics.json files generated with correct structure
- [ ] No compilation warnings with -Wall -Wextra
</verification>

<success_criteria>

- All tasks completed
- All verification checks pass
- DLX C++ iteration count matches C reference (43)
- CP C++ iteration count matches C reference (67)
- Both implementations integrated into benchmark system
  </success_criteria>

<output>
After completion, create `.planning/phases/07-c-family-languages/07-01-SUMMARY.md`:

# Phase 7 Plan 1: C++ Algorithms Summary

**Established DLX and CP algorithm implementations for C++ with verified correctness**

## Accomplishments

- Ported DLX algorithm to C++ (dlx.h, dlx_core.cpp, dlx_sudoku.cpp)
- Ported CP algorithm to C++ (cp.h, cp_core.cpp, cp_sudoku.cpp)
- Verified iteration counts match C reference (DLX: 43, CP: 67)
- Integrated both algorithms into benchmark system

## Files Created/Modified

- `Algorithms/DLX/C++/dlx.h` - DLX data structures
- `Algorithms/DLX/C++/dlx_core.cpp` - Core Algorithm X implementation
- `Algorithms/DLX/C++/dlx_sudoku.cpp` - Exact cover mapping and I/O
- `Algorithms/DLX/C++/runMe.sh` - Build and benchmark script
- `Algorithms/CP/C++/cp.h` - CP data structures
- `Algorithms/CP/C++/cp_core.cpp` - Constraint propagation core
- `Algorithms/CP/C++/cp_sudoku.cpp` - CP integration and I/O
- `Algorithms/CP/C++/runMe.sh` - Build and benchmark script

## Decisions Made

[Record any C++-specific decisions or deviations from C implementation]

## Issues Encountered

[Record any compilation issues, platform differences, or algorithm discrepancies]

## Next Step

Ready for 07-02-PLAN.md (C# implementation)
</output>
