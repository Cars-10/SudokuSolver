---
phase: 1.5.2-table-highlighting
plan: 02
type: execute
---

<objective>
Add enhanced columns to the main benchmark table for compiler version and memory peak.

Purpose: Display additional useful metrics directly in the main table view without needing to expand rows.
Output: Two new columns showing compiler version and peak memory usage for each language.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/1.5.2-table-highlighting/1.5.2-CONTEXT.md
@.planning/phases/1.5.2-table-highlighting/1.5.2-01-SUMMARY.md

**Relevant source files:**
@Metrics/HTMLGenerator.ts
@Metrics/LanguagesMetadata.ts
@Metrics/index.css
@Languages/C/metrics.json

**Data sources:**
- `languageMetadata` in LanguagesMetadata.ts may have compiler info
- `metrics.json` files have `memory` field per matrix result
- Peak memory = max(memory) across all matrix results for a language

**Target table structure (from CONTEXT.md):**
| Language | Score | M1 | M2 | M3 | M4 | M5 | Compiler | Mem Peak | Total | Status |
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add compiler version column</name>
  <files>Metrics/HTMLGenerator.ts, Metrics/LanguagesMetadata.ts, Metrics/index.css</files>
  <action>
    1. Check LanguagesMetadata.ts for existing compiler information structure
       - Look for fields like `compiler`, `version`, or similar in languageMetadata
       - If not present, we'll display "-" as placeholder

    2. In HTMLGenerator.ts, add a new column header after the matrix columns:
       ```html
       <th>
           Compiler
           <div class="sort-group">
               <button class="sort-btn" onclick="sortRows('compiler', this)" title="Sort by Compiler">C</button>
           </div>
       </th>
       ```

    3. In the row generation loop, add the compiler cell:
       ```html
       <td class="compiler-col">
           <div style="text-align: center; font-size: 0.85em;">
               ${compilerInfo || '-'}
           </div>
       </td>
       ```

       Where compilerInfo comes from:
       - languageMetadata[lang]?.compiler if available
       - Otherwise show language's typical compiler (e.g., "gcc" for C, "rustc" for Rust)
       - Use a simple mapping as fallback: { C: 'gcc', 'C++': 'g++', Rust: 'rustc', Go: 'go', ... }

    4. Add CSS for the new column:
       ```css
       .compiler-col {
           min-width: 80px;
           color: var(--muted);
       }
       ```

    5. Update the colspan in expanded-content row to account for new column
  </action>
  <verify>
    Open benchmark report - new "Compiler" column visible between matrices and Total Time. Shows compiler name for each language.
  </verify>
  <done>Compiler column displays in table with appropriate compiler names for each language</done>
</task>

<task type="auto">
  <name>Task 2: Add memory peak column</name>
  <files>Metrics/HTMLGenerator.ts, Metrics/index.css</files>
  <action>
    1. In HTMLGenerator.ts, calculate peak memory for each solver:
       ```typescript
       // In the metrics loop, after calculating other stats:
       const peakMemory = Math.max(...m.results.map(r => r.memory || 0));
       // Format: convert KB to MB if > 1024, otherwise show KB
       const memDisplay = peakMemory > 1024
           ? `${(peakMemory / 1024).toFixed(1)}MB`
           : `${peakMemory}KB`;
       ```

    2. Add new column header after Compiler column:
       ```html
       <th>
           Mem Peak
           <div class="sort-group">
               <button class="sort-btn" onclick="sortRows('memory', this)" title="Sort by Memory">M</button>
           </div>
       </th>
       ```

    3. Add the memory cell in each row:
       ```html
       <td class="memory-col" data-memory="${peakMemory}">
           <div style="text-align: center; font-size: 0.85em; color: var(--secondary);">
               ${memDisplay}
           </div>
       </td>
       ```

    4. Add CSS for memory column:
       ```css
       .memory-col {
           min-width: 70px;
       }
       ```

    5. In report_client.js, add sort handler for memory column if not already present:
       - Sort by the data-memory attribute (numeric sort)

    6. Update colspan in expanded-content row for the additional column

    7. Consider color coding based on memory usage:
       - Low (< 2MB): var(--primary) green
       - Medium (2-10MB): var(--secondary) cyan
       - High (> 10MB): warning color
  </action>
  <verify>
    1. Open benchmark report - "Mem Peak" column visible
    2. Shows actual memory values from metrics (e.g., "1.3MB", "2.1MB")
    3. Click sort button - rows sort by memory usage
    4. Values match the max memory from metrics.json for each language
  </verify>
  <done>Memory peak column displays max memory across all matrices, sortable, with appropriate formatting</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] "Compiler" column visible in table header
- [ ] "Mem Peak" column visible in table header
- [ ] Each row shows compiler name (or placeholder if unknown)
- [ ] Each row shows peak memory value formatted as KB/MB
- [ ] Sorting works for both new columns
- [ ] Column widths appropriate, no overflow issues
- [ ] Expanded content row colspan updated to match total columns
- [ ] No console errors
- [ ] Table still renders correctly at different viewport widths
</verification>

<success_criteria>
- All tasks completed
- All verification checks pass
- Two new columns (Compiler, Mem Peak) visible and functional
- Sorting works correctly for new columns
- No regressions to existing table functionality
- Phase 1.5.2 complete
</success_criteria>

<output>
After completion, create `.planning/phases/1.5.2-table-highlighting/1.5.2-02-SUMMARY.md`:

# Phase 1.5.2 Plan 02: Enhanced Table Columns Summary

**[Substantive one-liner describing what was accomplished]**

## Accomplishments
- [Key outcome 1]
- [Key outcome 2]

## Files Created/Modified
- `Metrics/HTMLGenerator.ts` - [Description of changes]
- `Metrics/index.css` - [Description of changes]
- `Metrics/report_client.js` - [Description of changes if any]

## Decisions Made
[Key decisions and rationale, or "None"]

## Issues Encountered
[Problems and resolutions, or "None"]

## Next Step
Phase 1.5.2 complete, ready for Phase 2 (Compiled Languages Wave)
</output>
